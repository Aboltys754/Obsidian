## Взаимодействие с ботом

### Ссылки на бота

Юзернеймы ботов работают так же, как и любые другие юзернеймы в Телеграме: бота `@examplebot` можно открыть по ссылке [t.me/examplebot](http://t.me/examplebot).

Также существует прямая ссылка: `tg://resolve?domain=examplebot`

Подробнее о ссылках tg://

Такие ссылки могут не только заменять ссылки [t.me](http://t.me/), но и задавать свои действия. Например, [tg://settings](http://tg//settings) открывает настройки.

Список известных таких ссылок есть канале [@DeepLink](http://tg//resolve?domain=DeepLink).

#### Ссылка на добавление в группу

По ссылке [t.me/examplebot?startgroup=true](http://t.me/examplebot?startgroup=true) у пользователя откроется меню: выбор группы для добавления бота.

Прямая ссылка: `tg://resolve?domain=examplebot&startgroup=true`

#### Диплинки

По ссылке `t.me/examplebot?start=<ваш текст>` пользователь может запустить бота с каким-то стартовым параметром (`<ваш текст>`).

Что происходит, когда пользователь переходит по такой ссылке:

1.  Бот открывается как обычно.
    
2.  Отображается кнопка "Запустить", даже если пользователь уже запускал бота.
    
3.  Пользователь нажимает на кнопку и видит сообщение `/start` (всё как обычно).
    
4.  Боту вместо этого приходит сообщение `/start <ваш текст>`
    

Так бот может отреагировать на запуск не как на обычный "/start", а другим способом.

Часто диплинки используются для реферальных программ (в качестве параметра можно передавать id пользователя, который поделился ссылкой). Есть и другие применения.

Прямая ссылка: `tg://resolve?domain=examplebot&start=<ваш текст>`


### Инлайн-режим

Инлайн-режим (inline mode) — это специальный режим работы бота, с помощью которого пользователь может использовать бота во всех чатах.

Выглядит это так: пользователь вводит юзернейм бота в поле для ввода сообщения. После юзернейма можно ещё записать запрос (текст до 256 символов).

Появляется менюшка с результатами. Выбирая результат, пользователь отправляет сообщение.

Инлайн-режим можно включить в BotFather, там же можно выбрать плейсхолдер вместо стандартного "Search..."

В группе можно запретить использовать инлайн всем или некоторым участникам. В официальных приложениях Телеграм это ограничение объединено с ограничением на отправку стикеров и GIF.

#### Результаты инлайн-режима

Результаты можно отображать двумя способами:

-   Сеткой. Удобно для выдачи картинок.
- Вертикальным списком. Удобно для выдачи текста.
- Можно совмещать два типа, но корректно отображается это только на Telegram Desktop.


#### Приватность и геопозиция в инлайне

Когда пользователь вызывает инлайн-режим, бот не может получить никакую информацию о контексте, кроме информации о пользователе. Таким образом, бот не может узнать ни чат, в котором вызвали инлайн, ни сообщение, на которое пользователь отвечает.

Но зато если включить в BotFather настройку "Inline Location Data", то бот сможет видеть геопозицию пользователей, когда они используют инлайн (на мобильных устройствах). Перед этим у пользователей показывается предупреждение.

#### Inline feedback

Inline feedback — это апдейты о выбранных инлайн-результатах. Включаются через BotFather.

Предполагается использование inline feedback для сбора статистики, но не всегда он используется так. Inline feedback позволяет "подгружать" не все результаты сразу, а только выбранный. Например, если бот используется для поиска музыки, то он может загружать не все песни сразу, а только одну.

Важный момент: если вы получили апдейт об отправке инлайн-сообщения, то вы можете его редактировать, только если к нему прикреплены инлайн-кнопки. (Если кнопок нет, то в апдейте не указывается id инлайн-сообщения, по которому происходит редактирование).

### Создание наборов стикеров

Боты (и только боты!) могут создавать наборы стикеров. При этом каждый набор стикеров должен принадлежать какому-то пользователю. Посмотреть свои наборы стикеров пользователь может с помощью бота [@Stickers](http://tg//resolve?domain=Stickers).

### Платежи через ботов

Телеграм предоставляет ботам возможность принимать платежи от пользователей. Это делается через провайдеров ЮMoney, Сбербанк, Stripe и ещё 7.

Эта возможность используются редко, потому что для использования провайдеров нужно юридическое лицо.

[Страница Bot Payments API](https://core.telegram.org/bots/payments)

_UPD 04.2021._ В новом обновлении появилось больше возможностей платежей для разработчиков. Теперь боты могут отправлять платежи не только в лс, но и в группы и в каналы. Это позволяет сделать из канала "витрину", на которой можно сразу купить товар. Вы можете посмотреть, как это выглядит, [в официальном демо-канале](https://t.me/TestStore/2).

### HTML-игры в ботах

Боты могут позволять пользователям играть в HTML5-игры в чатах. Бот может отправлять сообщения-игры или создавать их через инлайн-режим. Как это работает, можно посмотреть на примере официального [@gamebot](http://tg//resolve?domain=gamebot).

[Страница Bot Gaming Platform](https://core.telegram.org/bots/games)

### Telegram Login Widget

Вы можете добавить на свой сайт авторизацию через Телеграм. Процесс авторизации будет проходить так:

1.  Пользователь должен будет ввести свой номер телефона.
    
2.  Бот Telegram попросит подтвердить вход.
    
3.  Пользователь авторизуется и нажимает на "Принять" на сайте.