Когда нужно скачать видео с сайта, на помощь приходит библиотека requests, которая упрощает эту задачу до предела.

У метода `.get()` есть подходящий для этой цели параметр: `stream=True`.

`stream=True` позволяет поддерживать соединение, пока мы не получим весь требуемый контент. Этот параметр особенно полезен при скачивании больших файлов.

Если файл относительно небольшой, мы можем использовать `response.content` для его загрузки.

```python
import requests

# Выполняем GET-запрос к указанному URL с параметром stream=True.
# Параметр stream=True гарантирует, что соединение будет удерживаться, пока не будут получены все данные.
response = requests.get(url=url, stream=True)

# Открываем (или создаем) файл 'file.mp4' в режиме 'wb' (write binary),
# чтобы сохранить в него бинарные данные.
with open('file.mp4', 'wb') as file:

    # Записываем содержимое ответа (response.content) в файл.
    # Этот метод подходит для относительно небольших файлов,
    # так как все содержимое файла сначала загружается в оперативную память.
    file.write(response.content)
```

- `response = requests.get(url=url, **stream=True**)`: Здесь мы отправляем GET-запрос к заданному URL. Параметр **`stream=True`** позволяет удерживать соединение открытым до тех пор, пока не будут получены все данные.
    
- `with open('file.mp4', '**wb**') as file:`: Открываем (или создаем, если его нет) файл `file.mp4` в режиме записи бинарных данных (`wb`).
    
- `file.write(**response.content**)`: Записываем содержимое ответа (`response.content`) в файл. Этот метод хорошо подходит для загрузки небольших файлов, но для больших файлов он может быть неэффективным, так как всё содержимое сначала загружается в оперативную память.
    

Если файл очень большой или вы не хотите ждать, пока он полностью скачается, рекомендуется использовать `.iter_content()`. Этот метод позволяет итерироваться по `response.content`. Для `.iter_content()` нужно задать размер загружаемой порции файла с помощью параметра `chunk_size=1000000`, где указанная цифра — это размер в байтах.

```python
import requests
response = requests.get(url=url, stream=True)
with open('file.mp4', 'wb') as video:
    for piece in response.iter_content(chunk_size=100000):
        video.write(piece)
```

- **`response = requests.get(url=url, stream=True)`:**
    
    - **Для чего**: Выполнение GET-запроса для получения содержимого по заданному URL.
    - **Почему**: Нам нужно получить данные с этого URL.
    - **С какой целью**: Параметр `stream=True` позволяет загружать большие файлы по частям, минимизируя использование оперативной памяти.
- **`with open('file.mp4', 'wb') as video:`:**
    
    - **Для чего**: Открытие (или создание) файла `file.mp4` для записи в него данных.
    - **Почему**: В этот файл будет сохранен загруженный видеоконтент.
    - **С какой целью**: Мы используем режим `'wb'` (write binary) для сохранения бинарных данных.
- **`for piece in response.iter_content(chunk_size=100000):`:**
    
    - **Для чего**: Цикл для итерации по содержимому ответа (`response.content`), разбивая его на части.
    - **Почему**: Это позволяет загрузить файл по частям и сразу же записывать каждую часть в файл, минимизируя использование оперативной памяти.
    - **С какой целью**: Параметр `chunk_size=100000` задает размер каждой загружаемой части файла в байтах.
- **`video.write(piece)`:**
    
    - **Для чего**: Запись каждой загруженной части (`piece`) в файл.
    - **Почему**: Чтобы последовательно собрать весь файл из его частей.
    - **С какой целью**: После загрузки каждой части она сразу же записывается в файл, что позволяет экономить оперативную память и ускоряет процесс загрузки.

Чтобы успешно загрузить данные по ссылке с использованием библиотеки `requests` или других методов, важно, чтобы эта ссылка была прямой — то есть напрямую указывала на интересующий вас контент, будь то видео, изображение или текстовый файл. Прямая ссылка обычно оканчивается расширением файла (например, `.jpg` для изображений или `.mp4` для видео) и не содержит дополнительных параметров или редиректов, которые могут мешать процессу загрузки. Это значит, что при переходе по такой ссылке браузер сразу начнет загрузку файла, а не перенаправит вас на другую страницу или не потребует выполнения дополнительных действий. В контексте парсинга и автоматизации это особенно важно, так как прямые ссылки упрощают и ускоряют процесс извлечения данных.