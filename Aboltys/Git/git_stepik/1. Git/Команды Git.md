Git - один из самых востребованных инструментов DevOps, используемых для эффективной работы с небольшими и крупными проектами. Инструмент обеспечивает совместную работу разных людей в разных частях одного и того же проекта. Но Git не может работать без своих команд.

Работая над Git, мы активно используем два репозитория.

- **Локальный репозиторий** - это локальная копия всех файлов и папок, которые присутствуют на нашем компьютере. Этот репозиторий используется для внесения локальных изменений, просмотра истории изменений и фиксации в автономном режиме.
- **Удаленный репозиторий** - это серверная копия, которая может находиться на любом сервере. Этот репозиторий используется всеми членами команды для обмена внесенными изменениями.

Оба репозитория имеют свой собственный набор команд. Существуют отдельные команды Git, которые работают с разными типами репозиториев.

### Команды Git: работа с локальными репозиториями

#### git init

Команда `git init` используется для создания пустого репозитория Git. После использования команды `git init` в каталоге с некоторыми подкаталогами создается папка `.git`. Как только репозиторий инициализирован, начинается процесс создания других файлов.

```
git init
```

![](https://ucarecdn.com/da6bde5f-4f3b-41d3-8278-7912c692f50c/)

#### git add

Команда `add` используется после проверки состояния файлов, чтобы добавить эти файлы в промежуточную область. `git add` используется для добавления любых новых или измененных файлов.

```
git add
```

#### git commit

Команда `commit` гарантирует, что изменения будут сохранены в локальном репозитории. Команда `git commit –m <сообщение>` позволяет понять, какие изменения произошли.

```
git commit -m "commit message"
```

![](https://ucarecdn.com/c6749eab-a0a4-4b87-b5ad-fb5642919907/)

#### git status

Команда `git status` сообщает текущее состояние репозитория. Команда предоставляет текущую рабочую ветку. Если файлы находятся в промежуточной области, но не зафиксированы, это будет показано по статусу `git`. Кроме того, если изменений нет, отобразится сообщение никаких изменений для фиксации, рабочий каталог чист.

```
git status
```

![](https://ucarecdn.com/5e62b8f8-e28b-4a6c-b434-5c619dc2ae9e/)

#### git config

Команда `git config` изначально используется для настройки `user.name` и `user.email`. Здесь указывается, какой идентификатор электронной почты и имя пользователя будут использоваться из локального репозитория. Когда `git config` используется с флагом `--global`, он записывает настройки во все репозитории на компьютере.

```bash
git config --global user.name "any user name"
git config --global user.email <email id>
```

#### git branch

Команда `git branch` используется для определения, в какой ветви находится локальный репозиторий. Команда позволяет добавлять и удалять ветку.

```
# Создать новую ветку
git branch <branch_name>

# Список всех удаленных или локальных веток
git branch -a

# Удалить ветку
git branch -d <branch_name>
```

#### git checkout

Команда `git checkout` используется для переключения ветвей всякий раз, когда необходимо начать работу в другой ветке. Команда работает с тремя отдельными объектами: файлами, фиксациями и ветвями.

```
# Проверить существующую ветку
git checkout <branch_name>

# Проверить и создать новую ветку с этим именем
git checkout -b <new_branch>
```

#### git merge

Команда `git merge` используется для объединения ветвей вместе. Команда объединяет изменения из одной ветви в другую. Он используется для объединения изменений в промежуточной ветке со стабильной веткой.

```
git merge <branch_name>
```

### Команды Git: работа с удаленными репозиториями

#### git remote

Команда `git remote` используется для создания, просмотра и удаления подключений к другим репозиториям. Соединения здесь представляют собой не прямые ссылки на другие репозитории, а закладки, которые служат удобными именами для использования в качестве ссылки.

```
git remote add origin <address>
```

![](https://ucarecdn.com/1ff5fdbd-55f8-4d55-ad07-79b9a7aa1b45/)

#### git clone

Команда `git clone` используется для создания локальной рабочей копии существующего удаленного репозитория. Команда загружает удаленный репозиторий на компьютер. Она эквивалентна команде `git init` при работе с удаленным репозиторием.

```
git clone <remote_URL>
```

#### git pull

Команда `git pull` используется для извлечения и объединения изменений из удаленного репозитория в локальный репозиторий. Команда `git pull origin master` копирует все файлы из главной ветви удаленного репозитория в локальный репозиторий.

```
git pull <branch_name> <remote URL>
```

#### git push

Команда `git push` используется для передачи коммитов или отправки содержимого из локального репозитория в удаленный репозиторий. Команда используется после изменения локального репозитория, и изменения должны быть переданы удаленным членам команды.

```
git push -u origin master
```

![](https://ucarecdn.com/cc666243-c0bb-4ebe-99ef-d53cb369beb1/)

### Еще несколько команд Git

#### git stash

Команда `git stash` берет измененные отслеживаемые файлы и сохраняет их в виде кучи незавершенных изменений, которые можно повторно применить в любое время. Чтобы вернуться к работе, можно использовать всплывающее окно `stash`. Команда `git stash` поможет разработчику переключить ветки для работы над чем-то другим, не выполняя незавершенную работу.

```bash
# Сохранить текущую работу с неотслеживаемыми файлами
git stash -u

# Вернуть сохраненную работу обратно в рабочий каталог
git stash pop
```

#### git log

Команда `git log` показывает порядок истории фиксаций для репозитория. Команда помогает понять состояние текущей ветки, показывая коммиты, которые приводят к этому состоянию.

```bash
git log
```

![](https://ucarecdn.com/dc0bb082-b46a-4b9c-bb00-5328e72353b8/)

#### git reset 

![](https://ucarecdn.com/4427698d-61be-45cd-8b65-5f71e7788d40/)

Например, вы совершили десять коммитов. Использование `git reset` при первом коммите удалит все девять коммитов, вернув вас к первому этапу фиксации.

Перед использованием `git reset` важно рассмотреть тип изменений, которые вы планируете внести. Вы можете использовать несколько вариантов вместе с `git reset`. Каждый из них используется в зависимости от конкретной ситуации: `git reset --soft`, `git reset --mixed` и `git reset --hard`.

**git reset --soft**

Цель `--soft` - изменить ссылку HEAD (где последний коммит находится на вашем локальном компьютере) на конкретный коммит. Например, если мы поймем, что забыли добавить файл в коммит, мы можем вернуться назад, используя `--soft`:

- `git reset --soft HEAD~n` чтобы вернуться к фиксации с определенной ссылкой (n). `git reset --soft HEAD~1` возвращается к последней фиксации.
- `git reset --soft <commit ID>` возвращается к началу с `<commit ID>`

Давайте рассмотрим пример. Предположим, у нас 2 новых файла, и мы хотим сделать коммит.

![](https://ucarecdn.com/8d95b76e-62d1-4cbb-bffe-84e04ec27eed/)

```bash
git add data_acquisition.py data_preprocessing.py
git commit -m "added data acquisition and preprocessing scripts"
```

Это результат выполнения предыдущих команд:

![](https://ucarecdn.com/7161b04b-bd48-4400-bd23-bc7ed6afc98a/)

Мы можем проверить статус коммита следующим образом:

```bash
$ git status
```

![](https://ucarecdn.com/d8293aed-f22b-4eb4-8fc9-4091f47a9162/)

Проверим журнал git, чтобы просмотреть историю.

![](https://ucarecdn.com/0c2dd284-6be8-473b-a340-3c336049e84a/)

Затем выполним команду `git reset` с параметром `--soft`. И снова проверим журнал.

![](https://ucarecdn.com/df122f42-d647-4e99-a682-0a67260fcad6/)

Обратите внимание на изменения. Команда `git reset --soft HEAD~1` позволяет вернуться к предыдущему коммиту и продолжить работу над ним, сохраняя все изменения в рабочей копии.

**git reset --mixed**

Это аргумент по умолчанию для `git reset`. Это почти то же самое, что `git reset --soft`, но единственная разница в том, что он отменяет ваши изменения с последних коммитов. Представьте, что мы случайно добавили файл `model_training.py` и хотим удалить его, потому что обучение модели еще не закончено.

Алгоритм действий:

- Удалите файлы, которые были в коммите, с помощью `git reset HEAD`.
- Добавьте только те файлы, которые нужны для коммита.

```bash
$ git reset HEAD

$ git status

On branch master
Untracked files:
(use "git add <file>..." to include in what will be committed)
model_training.py
data_acquisition.py
data_preprocessing.py

nothing added to commit but untracked files present (use "git add" to track)
```

Теперь мы можем добавить только последние два файла, которые необходимо зафиксировать, и выполнить фиксацию (коммит).

```
$ git add data_acquisition.py data_preprocessing.py

$ git commit -m "Removed the model_training.py from the commit"
```

**git reset --hard**

Эта опция потенциально опасна, поэтому будьте осторожны. По сути, при использовании полной перезагрузки для определенного коммита это заставляет HEAD вернуться к этому коммиту и удаляет все остальное после него.

Перед запуском полной перезагрузки посмотрите содержимое папки.

```
$ ls
data_acquisition.py data_preprocessing.py model_training.py

$ git reset --hard
HEAD is now at 97159bc added data acquisition and preprocessing scripts
```

Если проверить содержимое после выполнения команды, можно увидеть следующее:

```
$ ls
data_acquisition.py data_preprocessing.py
```

Видим, что файл _model_training.py_ удален. Опять же, убедитесь, что понимаете, что вы делаете с инструкцией `reset`, потому что последствия могут быть необратимыми.